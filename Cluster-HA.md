# ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ **Clustering ‡πÅ‡∏•‡∏∞ High Availability (HA)** 

‡∏à‡∏∞‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á **Proxmox VE** ‡πÅ‡∏•‡∏∞ **Pure Linux KVM** ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡∏°‡∏≤‡∏Å ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ö‡∏ö‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°:

---

## üñ•Ô∏è **1. Clustering & HA ‡∏ö‡∏ô Proxmox VE**

Proxmox ‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö Clustering ‡πÅ‡∏•‡∏∞ HA **‡πÅ‡∏ö‡∏ö built-in** ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß

### ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°

* Server 2‚Äì3 ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Proxmox VE
* Network ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Node ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ (‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö cluster traffic)
* Shared Storage ‡πÄ‡∏ä‡πà‡∏ô NFS, iSCSI, Ceph (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ Live Migration ‡πÅ‡∏•‡∏∞ HA)

### üîß ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Cluster + HA

#### 1. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Proxmox VE ‡∏ö‡∏ô‡∏ó‡∏∏‡∏Å Node

```bash
apt update && apt full-upgrade
```

#### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ hostname ‡πÅ‡∏•‡∏∞ IP ‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô

#### 3. ‡∏ö‡∏ô Node ‡πÅ‡∏£‡∏Å (‡πÄ‡∏ä‡πà‡∏ô `pve1`) ‡∏™‡∏£‡πâ‡∏≤‡∏á Cluster:

```bash
pvecm create my-cluster
```

#### 4. ‡∏ö‡∏ô Node ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (‡πÄ‡∏ä‡πà‡∏ô `pve2`, `pve3`) ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏° Cluster:

```bash
pvecm add <IP-‡∏Ç‡∏≠‡∏á-node‡πÅ‡∏£‡∏Å>
```

#### 5. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Cluster:

```bash
pvecm status
```

#### 6. ‡πÄ‡∏û‡∏¥‡πà‡∏° Shared Storage ‡∏ú‡πà‡∏≤‡∏ô Web UI:

* ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `Datacenter > Storage` > Add NFS/iSCSI/Ceph/ZFS

#### 7. ‡πÄ‡∏õ‡∏¥‡∏î HA Manager:

* ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `Datacenter > HA`
* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡πà‡∏≤ VM ‡πÑ‡∏´‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ HA
* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏é Failover/Restart

#### 8. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Failover:

* ‡∏õ‡∏¥‡∏î Node ‡∏´‡∏ô‡∏∂‡πà‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ß‡πà‡∏≤ VM ‡∏ñ‡∏π‡∏Å‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ Node ‡∏≠‡∏∑‡πà‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

> üí° Proxmox ‡πÉ‡∏ä‡πâ `corosync` ‡πÄ‡∏õ‡πá‡∏ô backend ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö clustering ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ `ha-manager` ‡πÄ‡∏õ‡πá‡∏ô daemon ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö HA

---

## üß± **2. Clustering & HA ‡∏ö‡∏ô Linux KVM (libvirt/pacemaker)**

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö pure Linux KVM ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö clustering/HA ‡πÅ‡∏ö‡∏ö built-in ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ **‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ú‡∏™‡∏°‡∏Å‡∏±‡∏ô** ‡πÄ‡∏ä‡πà‡∏ô:

* `libvirt` / `virsh` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ VM
* `corosync` + `pacemaker` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö cluster communication ‡πÅ‡∏•‡∏∞ resource management
* `DRBD` ‡∏´‡∏£‡∏∑‡∏≠ shared storage (NFS/iSCSI/GlusterFS) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö disk image ‡∏Ç‡∏≠‡∏á VM
* `crmsh` ‡∏´‡∏£‡∏∑‡∏≠ `pcs` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ pacemaker

### ‚úÖ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°

* Server 2‚Äì3 ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Linux (‡πÄ‡∏ä‡πà‡∏ô CentOS, RHEL, Debian)
* ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á `libvirt`, `qemu`, `pacemaker`, `corosync`, `pcs`
* Network connectivity ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á node
* Shared storage ‡∏´‡∏£‡∏∑‡∏≠ replicated storage

### üîß ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô (‡πÇ‡∏î‡∏¢‡∏™‡∏£‡∏∏‡∏õ)

#### 1. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Package ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô:

```bash
apt install qemu-kvm libvirt-daemon corosync pacemaker pcs
```

#### 2. ‡∏ï‡∏±‡πâ‡∏á hostname ‡πÅ‡∏•‡∏∞ `/etc/hosts` ‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ resolve ‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å node

#### 3. ‡∏Å‡∏≥‡∏´‡∏ô‡∏î corosync config (`/etc/corosync/corosync.conf`) ‡πÅ‡∏•‡∏∞ start cluster:

```bash
pcs cluster auth node1 node2
pcs cluster setup --name mycluster node1 node2
pcs cluster start --all
```

#### 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á VM ‡∏î‡πâ‡∏ß‡∏¢ `virsh` ‡∏´‡∏£‡∏∑‡∏≠ `virt-manager`

#### 5. ‡πÄ‡∏û‡∏¥‡πà‡∏° VM ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö pacemaker:

```bash
pcs resource create myvm VirtualDomain \
  hypervisor="qemu:///system" \
  config="/etc/libvirt/qemu/myvm.xml" \
  migration_transport="ssh" \
  op start timeout=120s \
  op stop timeout=120s \
  op monitor interval=30s
```

#### 6. ‡∏Å‡∏≥‡∏´‡∏ô‡∏î resource constraints ‡πÅ‡∏•‡∏∞ failover rules:

```bash
pcs resource location myvm prefers node1
pcs constraint order start mydrbd then myvm
```

#### 7. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Failover:

* ‡∏õ‡∏¥‡∏î node ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô VM ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ß‡πà‡∏≤ pacemaker ‡∏à‡∏∞‡∏¢‡πâ‡∏≤‡∏¢ VM ‡πÑ‡∏õ node ‡∏≠‡∏∑‡πà‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

> üí° ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ HA ‡πÉ‡∏ô KVM ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ CLI ‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏î‡πâ‡∏≤‡∏ô cluster ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Proxmox

---

## üìå ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ö‡∏ö‡∏£‡∏ß‡∏ö‡∏£‡∏±‡∏î

| ‡∏î‡πâ‡∏≤‡∏ô             | Proxmox VE           | Linux KVM + Pacemaker        |
| ---------------- | -------------------- | ---------------------------- |
| ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢         | ‚úÖ ‡∏™‡∏π‡∏á (Web UI)       | ‚ùå ‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô ‡∏ï‡πâ‡∏≠‡∏á CLI           |
| ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ | ‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å (15‚Äì30 ‡∏ô‡∏≤‡∏ó‡∏µ) | ‡∏ô‡∏≤‡∏ô (1‚Äì2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤) |
| ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô     | ‡∏Å‡∏•‡∏≤‡∏á                 | ‡∏™‡∏π‡∏á                          |
| ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£       | ‡∏™‡∏π‡∏á                  | ‡∏™‡∏π‡∏á (‡∏´‡∏≤‡∏Å config ‡∏î‡∏µ)          |
| ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö         | Admin ‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö       | Admin ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç Linux, HA    |

---

‡∏´‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ walkthrough ‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö **‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏ô‡∏∂‡πà‡∏á** ‡πÄ‡∏ä‡πà‡∏ô Proxmox VE ‡∏´‡∏£‡∏∑‡∏≠ Pacemaker + KVM ‡∏ú‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÅ‡∏ö‡∏ö step-by-step ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö ‚úÖ
